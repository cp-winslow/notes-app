<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Sticky Notes</title>

  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"
    integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  <link href="main.css" rel="stylesheet">
</head>
<body>
  <div class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
    <div class="container d-flex justify-content-between">
      <a href="#" class="navbar-brand">Sticky Notes</a>
    </div>
  </div>

  <section class="jumbotron text-center">
    <div class="container">
      <h1 class="jumbotron-heading">Sticky Notes</h1>
      <p class="lead text-muted">Simply add a note and save rainforests!</p>
      <p>
        <a href="#" class="btn btn-primary">Add a note</a>
      </p>
    </div>
  </section>

  <div class="board text-muted">
    <div class="container">

      <div class="row">
        <div class="note">
          <div class="note-header">
            <h5 class="modal-title">Sticky note 1.</h5>
          </div>
          <div class="note-body">
            <p class="note-text" contenteditable="true">Lorem ipsum dolor sit amet,
              consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna
              aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip
              ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
              cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident,
              sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          </div>
          <div class="note-footer">
            <button type="button" class="close" aria-label="Delete">
              <span aria-hidden="true" class="fa fa-trash-o text-danger"></span>
            </button>
          </div>
        </div>
        <div class="note">
          <div class="note-header">
            <h5 class="modal-title">Sticky note 2.</h5>
          </div>
          <div class="note-body">
            <p class="note-text" contenteditable="true">Lorem ipsum dolor sit amet,
              consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna
              aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip
              ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
              cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident,
              sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          </div>
          <div class="note-footer">
            <button type="button" class="close" aria-label="Delete">
              <span aria-hidden="true" class="fa fa-trash-o text-danger"></span>
            </button>
          </div>
        </div>
        <div class="note">
          <div class="note-header">
            <h5 class="modal-title">Sticky note 3.</h5>
          </div>
          <div class="note-body">
            <p class="note-text" contenteditable="true">Lorem ipsum dolor sit amet,
              consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna
              aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip
              ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
              cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident,
              sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
          </div>
          <div class="note-footer">
            <button type="button" class="close" aria-label="Delete">
              <span aria-hidden="true" class="fa fa-trash-o text-danger"></span>
            </button>
          </div>
        </div>
      </div>

    </div>
  </div>

  <footer class="text-muted">
    <div class="container">
      <p class="float-right">
        <a href="#">Back to top</a>
      </p>
      <p>&copy; Salvum Ligna Inc.</p>
    </div>
  </footer>
  <script>
    /*
    Add a function to index.html that uses [XMLHttpRequest] or [fetch] to add a note by posting json data to end-point "/api/notes".
    Add event listener to "add a note" button, that will create a note node where you can type in the text.
    Once you click outside, it should POST to endpoint to create the note.

    Push changes to your notes-app fork. Also copy changed index.html to push to your assigments branch for this class.

    [XMLHttpRequest](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest)
    [fetch](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)

    */
    function postData(url = '', data = {}) {
      // Default options are marked with *
        return fetch(url, {
            method: 'POST', // *GET, POST, PUT, DELETE, etc.
            mode: 'cors', // no-cors, cors, *same-origin
            cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached
            credentials: 'same-origin', // include, *same-origin, omit
            headers: {
                'Content-Type': 'application/json',
                // 'Content-Type': 'application/x-www-form-urlencoded',
            },
            redirect: 'follow', // manual, *follow, error
            referrer: 'no-referrer', // no-referrer, *client
            body: JSON.stringify(data), // body data type must match "Content-Type" header
        })
        .then(response => response.json()); // parses JSON response into native JavaScript objects
    }

    function addNote() {
      const containerRow = document.querySelector(".row");

      const newNoteHTML = `
      <div class="note">
        <div class="note-header">
          <h5 class="modal-title">Sticky note 1.</h5>
        </div>
        <div class="note-body">
          <p class="note-text" contenteditable="true">Add your Sticky Note here!</p>
        </div>
        <div class="note-footer">
          <button type="button" class="close" aria-label="Delete">
            <span aria-hidden="true" class="fa fa-trash-o text-danger"></span>
          </button>
        </div>
      </div>`

      containerRow.insertAdjacentHTML("beforeend", newNoteHTML);
    }

    let noteData = {
      "note": containerRow.lastElementChild.children[1].firstElementChild.innerText;
    }

    const addNoteBtn = document.querySelector(".btn.btn-primary");

    addNoteBtn.addEventListener("click", (e) => {
      e.preventDefault();
      addNote();
    });

    addNoteBtn.removeEventListener("click", (e) => {
      e.preventDefault();
      postData('/api/notes', noteData)
        .then(data => console.log(JSON.stringify(data))) // JSON-string from `response.json()` call
        .catch(error => console.error(error));
    });
  </script>
</body>
</html>
